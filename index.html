<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Customer Insights — Dashboard</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    :root {
      --bg1: #2a2f45;
      --bg2: #6f4bd8;
      --card: rgba(255,255,255,0.06);
      --accent: #7be0ff;
    }
    html,body { height:100%; margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: linear-gradient(160deg,var(--bg1) 0%, var(--bg2) 100%); color:#e9eef8; }
    .app-shell { max-width:1200px; margin:36px auto; padding:24px; }
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); border-radius:14px; padding:18px; box-shadow: 0 8px 30px rgba(2,6,23,0.5); border: 1px solid rgba(255,255,255,0.04); }
    .topbar { display:flex; align-items:center; gap:16px; margin-bottom:18px; }
    .brand { font-weight:700; font-size:1.15rem; display:flex; gap:10px; align-items:center; }
    .small-muted { color: rgba(233,238,248,0.6); font-size:0.9rem; }

    /* stats */
    .stat { padding:18px; border-radius:12px; background: linear-gradient(180deg, rgba(255,255,255,0.025), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.03); }
    .stat .value { font-size:1.4rem; font-weight:700; color:#fff; }
    .stat .label { font-size:0.85rem; color:rgba(233,238,248,0.7); }

    /* table */
    table.data { background: transparent; color:#e9eef8; }
    .table thead th { background: rgba(255,255,255,0.05); border-bottom:1px solid rgba(255,255,255,0.04); color: #dfe8ff; }
    .table tbody tr:hover { background: rgba(255,255,255,0.02); }

    /* input */
    .sheet-input { background: rgba(0,0,0,0.2); color:#fff; border: none; border-radius:10px; padding:12px; width:100%;}
    .btn-primary { background: linear-gradient(90deg,#6c4ef8,#3ab1ff); border: none; box-shadow: 0 6px 20px rgba(59,177,255,0.12); }

    /* footer & small */
    .muted { color: rgba(233,238,248,0.6); }

    @media (max-width: 768px) {
      .chart-col { order: 2; }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <div class="glass topbar">
      <div class="brand">
        <i class="fas fa-chart-line" style="color:var(--accent);"></i>
        <div>
          <div style="font-size:1.05rem;font-weight:700;">Customer Insights</div>
          <div class="small-muted">Professional dashboard — live from Google Sheets</div>
        </div>
      </div>
      <div class="ms-auto text-end">
        <div class="muted">Made for: <strong>Your Team</strong></div>
      </div>
    </div>

    <!-- configuration card -->
    <div class="glass mb-4">
      <div class="row g-3 align-items-center">
        <div class="col-md-9">
          <label class="small-muted">Google Sheet ID</label>
          <input id="sheetInput" class="sheet-input" placeholder="Paste Sheet ID (only the long id between /d/ and /edit)" />
          <div class="muted mt-1">Share your sheet: <strong>Anyone with the link → Viewer</strong></div>
        </div>
        <div class="col-md-3 d-grid">
          <button id="loadBtn" class="btn btn-primary">Load Data</button>
        </div>
      </div>
      <div id="shareRow" class="mt-3" style="display:none">
        <label class="small-muted">Shareable dashboard URL</label>
        <div class="input-group">
          <input id="shareUrl" class="sheet-input" readonly>
          <button class="btn btn-outline-light" id="copyShare"><i class="fas fa-copy"></i></button>
        </div>
      </div>
    </div>

    <!-- stats + charts -->
    <div class="row g-3 mb-4">
      <div class="col-lg-3 col-md-6">
        <div class="stat text-center">
          <div class="label muted">Total Customers</div>
          <div id="totalCustomers" class="value">0</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="stat text-center">
          <div class="label muted">Total Orders</div>
          <div id="totalOrders" class="value">0</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="stat text-center">
          <div class="label muted">Total Revenue</div>
          <div id="totalRevenue" class="value">$0</div>
        </div>
      </div>
      <div class="col-lg-3 col-md-6">
        <div class="stat text-center">
          <div class="label muted">Avg Order Value</div>
          <div id="avgOrder" class="value">$0</div>
        </div>
      </div>
    </div>

    <div class="row g-3 mb-4">
      <div class="col-lg-7">
        <div class="glass">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div><strong>Customers</strong> — grouped by phone</div>
            <div class="small-muted">Click a row for details</div>
          </div>
          <div class="table-responsive">
            <table class="table table-borderless data">
              <thead>
                <tr>
                  <th>Phone</th>
                  <th>Name</th>
                  <th>Orders</th>
                  <th>Avg Check</th>
                  <th>Total Spent</th>
                  <th>Last Order</th>
                </tr>
              </thead>
              <tbody id="customerTable"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="col-lg-5 chart-col">
        <div class="glass mb-3">
          <div class="mb-2"><strong>Orders per Month</strong></div>
          <canvas id="ordersMonthChart" height="180"></canvas>
        </div>

        <div class="glass mb-3">
          <div class="row">
            <div class="col-6">
              <div class="mb-2"><strong>Avg Check (Top customers)</strong></div>
              <canvas id="avgCheckChart" height="150"></canvas>
            </div>
            <div class="col-6">
              <div class="mb-2"><strong>Payment Methods</strong></div>
              <canvas id="paymentChart" height="150"></canvas>
            </div>
          </div>
        </div>

        <div class="glass">
          <div class="mb-2"><strong>Spending by Restaurant</strong></div>
          <canvas id="restaurantChart" height="120"></canvas>
        </div>
      </div>
    </div>

    <div class="glass mt-3">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <div><strong>Selected Customer — Order History</strong></div>
        <div class="small-muted" id="selectedPhoneInfo">No customer selected</div>
      </div>
      <div class="table-responsive">
        <table class="table table-sm table-borderless data">
          <thead>
            <tr><th>Date</th><th>Restaurant</th><th>Payment</th><th>Amount</th></tr>
          </thead>
          <tbody id="orderHistory"></tbody>
        </table>
      </div>
    </div>

    <div class="text-center muted mt-3">Built with • Google Sheets • GitHub Pages • Chart.js</div>
  </div>

  <script src="app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
